(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/index"],{"0609":function(e,t,i){"use strict";i.r(t);var n=i("dfab"),r=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=r.a},"2b66":function(e,t,i){"use strict";var n=i("b5b4"),r=i.n(n);r.a},"5f74":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=(e._self._c,e.isLoading?null:e.formatPrice(e.service.price)),n=e.isLoading?null:e.hygieneOptions.indexOf(e.hygiene),r=e.isLoading?null:e.formatPrice(e.price);e.$mp.data=Object.assign({},{$root:{m0:i,g0:n,m1:r}})},r=[]},8137:function(e,t,i){"use strict";(function(e,t){var n=i("4ea4");i("833b");n(i("66fd"));var r=n(i("ac52"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(r.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},ac52:function(e,t,i){"use strict";i.r(t);var n=i("5f74"),r=i("0609");for(var a in r)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(a);i("2b66");var c=i("f0c5"),s=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=s.exports},b5b4:function(e,t,i){},dfab:function(e,t,i){"use strict";(function(e){var n=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(i("2eee")),a=n(i("c973")),c=i("0ffc"),s={data:function(){return{service:{},hygiene:"简单",hygieneOptions:["简单","中等","困难"],isMember:!1,address:"",date:"",remark:"",price:0,loading:!1,isLoading:!0,loadError:!1,touched:{address:!1,date:!1}}},computed:{isFormValid:function(){return this.address&&this.date}},onLoad:function(e){this.loadService()},methods:{formatPrice:function(e){return(e||0).toFixed(2)},loadService:function(){try{var e=getApp().globalData.service;if(!e||!e.price)throw new Error("服务数据不完整");this.service=e,this.price=this.service.price,this.isLoading=!1}catch(t){console.error("加载失败:",t),this.loadError=!0,this.isLoading=!1}},reloadService:function(){this.isLoading=!0,this.loadError=!1,this.loadService()},onHygieneChange:function(e){this.hygiene=this.hygieneOptions[e.detail.value],this.calculatePrice()},onMemberChange:function(e){this.isMember=e.detail.value.includes("member"),this.calculatePrice()},onDateChange:function(e){this.date=e.detail.value,this.touched.date=!0},calculatePrice:function(){var e={"简单":.9,"中等":1,"困难":1.1}[this.hygiene]||1;this.price=(this.service.price||0)*e*(this.isMember?.85:1)},getHygieneMultiplierText:function(){return{"简单":"0.9倍","中等":"1.0倍","困难":"1.1倍"}[this.hygiene]||"1.0倍"},handleBlur:function(e){this.touched[e]=!0},submitOrder:function(){var t=this;return(0,a.default)(r.default.mark((function i(){var n;return r.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.isFormValid){i.next=4;break}return t.touched.address=!t.address,t.touched.date=!t.date,i.abrupt("return",e.showToast({title:"请完成必填信息",icon:"none"}));case 4:return t.loading=!0,i.prev=5,i.next=8,(0,c.addOrder)({serviceId:t.service.id,hygiene:t.hygiene,isMember:t.isMember,address:t.address,date:t.date,remark:t.remark,price:t.price});case 8:n=i.sent,n[1].data.success?(e.showToast({title:"订单提交成功",icon:"success",duration:2e3}),setTimeout((function(){return e.navigateBack()}),2e3)):e.showToast({title:n[1].data.message||"订单提交失败",icon:"none"}),i.next=16;break;case 12:i.prev=12,i.t0=i["catch"](5),console.error("提交失败:",i.t0),e.showToast({title:"网络错误，请稍后再试",icon:"none"});case 16:return i.prev=16,t.loading=!1,i.finish(16);case 19:case"end":return i.stop()}}),i,null,[[5,12,16,19]])})))()}}};t.default=s}).call(this,i("543d")["default"])}},[["8137","common/runtime","common/vendor"]]]);